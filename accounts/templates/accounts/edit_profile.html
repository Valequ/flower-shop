{% extends "main/base_light.html" %}
{% load static %}
{% block content %}
  <div class="content_column">
    <div class="line2"></div>
    <a href="{% url 'accounts:profile' %}" class="back-to-profile">
        ← Назад в профиль
    </a>
    <div class="profile-container">
        <div class="edit-profile-header">
            <h2 class="login-h2">Редактирование профиля</h2>
        </div>
        <div id="profile-message" class="profile-message"></div>
        <div id="loading-indicator" class="loading-indicator" style="display: none;">
            <div class="loading-spinner"></div>
            <p>Загрузка данных...</p>
        </div>    
        <div id="profile-content" class="profile-sections">
            <div class="edit-profile-card">
            <div class="edit-avatar-section">
                <div class="current-avatar-container">
                    <img class="current-avatar" id="current-avatar" 
                        src="{{ request.user.get_avatar_url }}" 
                        alt="Текущий аватар">
                    <div class="avatar-overlay" onclick="document.getElementById('avatar-input').click()">
                        <span class="avatar-overlay-text">✎</span>
                    </div>
                </div>
                
                <div class="avatar-upload-section">
                    <h3 class="section-title">Сменить аватар</h3>            
                    <form method="POST" action="{% url 'accounts:upload_avatar' %}" 
                        enctype="multipart/form-data" id="avatar-form">
                        {% csrf_token %}
                        <div class="upload-controls">
                            <input type="file" id="avatar-input" name="avatar" 
                                class="file-input" accept="image/*" style="display: none;"
                                onchange="handleAvatarSelect(event)">
                            <button type="button" class="upload-btn" 
                                    onclick="document.getElementById('avatar-input').click()">
                                Выбрать файл
                            </button>
                            <button type="submit" class="upload-btn" style="margin-left: 10px;">
                                Загрузить
                            </button>
                            <span id="file-name" class="file-name">Файл не выбран</span>
                        </div>
                    </form>
                </div>
            </div>                
                <div class="edit-data-section">
                    <h3 class="section-title">Личные данные</h3>
                    
                    <div class="form-group">
                        <label for="edit-username" class="form-label">Логин</label>
                        <input type="text" id="edit-username" class="form-input" disabled>
                        <div class="form-help">Логин нельзя изменить</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-full-name" class="form-label">ФИО</label>
                        <input type="text" id="edit-full-name" class="form-input" placeholder="Введите ваше ФИО">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-phone" class="form-label">Телефон</label>
                        <input type="tel" id="edit-phone" class="form-input" placeholder="+7 (___) ___-__-__">
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-email" class="form-label">Электронная почта</label>
                        <input type="email" id="edit-email" class="form-input" placeholder="email@example.com">
                    </div>
                    
                    <div class="form-actions">
                        <button class="btn-primary" onclick="saveProfile()">
                            Сохранить изменения
                        </button>
                        <a href="{% url 'accounts:profile' %}" class="btn-secondary">
                            Отмена
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}